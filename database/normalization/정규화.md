# 정규화

## 정규화란

관계형 데이터베이스 데이터 모델의 중복을 최소화하고 데이터의 일관성, 유연성을 확보하기 위한 목적으로 데이터를 분해하는 과정

## 정규화 목적

- 중복을 배제하여 삽입, 삭제, 갱신 이상의 발생을 방지
- 불필요하거나 중복되는 데이터 제거
- 효과적인 검색 알고리즘 생성 기능

### 이상(Anomaly) 현상

- 정규화를 거치지 않은 데이터베이스에서 발생할 수 있는 현상
- 데이터들이 불필요하게 중복되어 릴레이션 조작에 예기치 못한 문제 발생

### 이상 종류

1. 삽입 이상
    - 데이터 삽입 시 의도와 다른 값들도 삽입되는 현상
2. 삭제 이상
    - 데이터 삭제 시 의도와 다른 값들도 연쇄 삭제되는 현상
3. 갱신 이상
    - 속성값 갱신 시 일부 튜플만 갱신되어 모순이 발생하는 현상

## 정규화 과정

### 1. 제1정규화(1NF)

> 모든 도메인이 원자값으로 이루어져야함.
> 

- #### 1NF를 만족하지 않는 릴레이션

    | 수강 과목 | 수강자 |
    | --- | --- |
    | 수학 | 홍길동 |
    | 과학 | 임꺽정, 신사임당 |
    | 사회 | 홍길동, 임꺽정 |

    → 수강자 속성이 원자값이 아님.

- #### 발생할 수 있는 이상의 예
    - 갱신 이상: 홍길동이 사회 과목을 ‘역사’로 바꾸었는데, 임꺽정이 듣고 있는 사회 과목도 바뀌어버림.
    - 삭제 이상: 임꺽정이 과학 과목을 수강 취소했는데, 신사임당의 과학 과목 신청 정보도 삭제됨.

- #### 제1정규화 적용
    1. 원자값을 튜플로 분해한다.
    2. 기본키를 생성한다.

        | 일련번호 | 수강자 | 수강 과목 |
        | --- | --- | --- |
        | 1 | 홍길동 | 수학 |
        | 2 | 임꺽정 | 과학 |
        | 3 | 신사임당 | 과학 |
        | 4 | 홍길동 | 사회 |
        | 5 | 임꺽정 | 사회 |

### 2. 제2정규화(2NF)

> 부분적 함수 종속을 제거해야함. → 완전 함수 종속이 되어야 함. (+제1정규화 만족)
> 

- #### 2NF를 만족하지 않는 릴레이션(기본키: 학번)

    | 학번 | 이름 | 소속학과 | 학과장 |
    | --- | --- | --- | --- |
    | 1901 | 홍길동 | 컴퓨터과 | 김교수 |
    | 1845 | 임꺽정 | 전자과 | 박교수 |
    | 1706 | 신사임당 | 기계과 | 천교수 |
    | 1925 | 장영실 | 컴퓨터과 | 김교수 |

    → 학과장 속성은 소속학과 속성에 종속되므로(=학과장은 소속학과만으로도 결정됨) 부분적 함수 종속 관계임.

    → 따라서 학과장이 이 릴레이션에 있게 되면 ‘김교수’ 와 같이 계속 중복 적재 될 것임.

- #### 발생할 수 있는 이상의 예
    - 삽입 이상: 컴퓨터과, 전자과, 기계과 학생을 추가하고자 할 경우 더이상 불필요한 중복정보인 학과장 정보가 삽입되어야 함.
    - 갱신 이상: 컴퓨터과의 학과장이 변경될 경우, 하나만 변경하면 모순이 발생하기 때문에 모두 찾아서 변경해주어야 함.
    - 삭제 이상: 신사임당 학생 정보를 삭제하는 경우, 기계과 학과장의 정보가 사라져버림.

- #### 제2정규화 적용
    
    → 릴레이션을 구분하여 부분 함수 종속을 제거한다.
    

    | 학번 | 이름 | 소속학과 |
    | --- | --- | --- |
    | 1901 | 홍길동 | 컴퓨터과 |
    | 1845 | 임꺽정 | 전자과 |
    | 1706 | 신사임당 | 기계과 |
    | 1925 | 장영실 | 컴퓨터과 |

    | 학과 | 학과장 |
    | --- | --- |
    | 컴퓨터과 | 김교수 |
    | 전자과 | 박교수 |
    | 기계과 | 천교수 |

### 3. 제3정규화(3NF)

> 이행 함수 종속성을 제거해야함. (+ 제2정규화 만족)
> 
- 이행 함수 종속:
    - A → B 이고 B → C 일 때 A → C인 관계

- #### 3NF를 만족하지 않는 릴레이션(기본키: 학번)

    | 학번 | 이름 | 소속학과 | 대학 |
    | --- | --- | --- | --- |
    | 1901 | 홍길동 | 컴퓨터과 | 공대 |
    | 1845 | 임꺽정 | 전자과 | 공대 |
    | 1706 | 신사임당 | 경제 | 경상 |
    | 1925 | 장영실 | 경영 | 경상 |

    → 소속학과는 특정 대학에 종속한다.

    따라서  `홍길동 -> 컴퓨터과` 이고 `컴퓨터과 -> 공대` 일 때, `홍길동 -> 공대` 인 관계가 성립한다.

- #### 발생할 수 있는 이상의 예
    - 삽입 이상: 컴퓨터과, 전자과 학생을 추가하고자 할 경우 더이상 불필요한 중복 정보인 대학 정보가 삽입되어야 함.
    - 갱신 이상: 컴퓨터과의 소속 대학이 ‘IT대학’으로 변경될 경우, 하나만 변경하면 모순이 발생하므로 모두 찾아서 변경해야 함.
    - 삭제 이상: 홍길동에 대한 정보를 삭제하면, 컴퓨터과의 대학 정보까지 삭제되어버림.

- #### 제3정규화 적용
    
    → 릴레이션을 구분하여 이행적 함수 종속을 제거한다.
    

    | 학번 | 이름 | 소속학과 |
    | --- | --- | --- |
    | 1901 | 홍길동 | 컴퓨터과 |
    | 1845 | 임꺽정 | 전자과 |
    | 1706 | 신사임당 | 경제 |
    | 1925 | 장영실 | 경영 |

    | 소속학과 | 대학 |
    | --- | --- |
    | 컴퓨터과 | 공대 |
    | 전자과 | 공대 |
    | 경제 | 경상 |
    | 경영 | 경상 |

### 4. BCNF

> 모든 결정자가 후보키가 되도록 테이블 분해
> 
- #### 후보키: 슈퍼키 중에서 최소성을 갖는 키

- #### BCNF를 만족하지 않는 릴레이션 (기본키: 학번, 과목명)

    | 학번 | 과목명 | 담당교수 |
    | --- | --- | --- |
    | 100 | C123 | 김교수 |
    | 100 | C234 | 박교수 |
    | 200 | C123 | 김교수 |
    | 300 | C234 | 천교수 |
    | 400 | C234 | 이교수 |

    → 담당교수가 과목명을 결정하고 있지만, 담당 교수는 후보키가 아님

- #### 발생할 수 있는 이상의 예
    - 삽입 이상: 새로운 교수가 특정 과목을 담당한다는 정보를 추가하려면, 한 명 이상의 수강생(=학번)이 필요함.
    - 삭제 이상: 학번 100이 C234 과목을 취소하면, P2가 C234를 담당한다는 정보도 삭제됨.
    - 갱신 이상: P1 과목이 변경되면 P1인 행을 모두 찾아 변경시켜줘야 함.

- #### BCNF 적용
    
    → 담당교수 속성이 후보키가 되도록 릴레이션을 분해한다.
    

    | 학번 | 담당교수 |
    | --- | --- |
    | 100 | P1 |
    | 100 | P2 |
    | 200 | P1 |
    | 300 | P3 |
    | 400 | P4 |

    | 담당교수 | 과목명 |
    | --- | --- |
    | P1 | C123 |
    | P2 | C234 |
    | P3 | C234 |
    | P4 | C234 |
    
---
### 참고
https://itwiki.kr/w/%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4_%EC%A0%95%EA%B7%9C%ED%99%94

https://mangkyu.tistory.com/110

https://rebro.kr/160
